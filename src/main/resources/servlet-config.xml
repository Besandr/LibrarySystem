<?xml version="1.0" encoding="UTF-8" ?>

<!--File with configuration of ActionServlet-->

<servlet-config>
    <!--
    <forms> tag contains forms which is needed for corresponding
    bound by name actions. Tags <formName> for mapping to action and
    <type> of Form class are mandatory
    -->
    <forms>
        <form>
            <name>bookSearchForm</name>
            <type>com.library.web.controllers.forms.BookSearchForm</type>
        </form>
        <form>
            <name>OrderBookForm</name>
            <type>com.library.web.controllers.forms.OrderBookForm</type>
        </form>
        <form>
            <name>userLoginForm</name>
            <type>com.library.web.controllers.forms.UserLoginForm</type>
        </form>
        <form>
            <name>userRegistrationForm</name>
            <type>com.library.web.controllers.forms.UserRegistrationForm</type>
        </form>
        <form>
            <name>approveLoanForm</name>
            <type>com.library.web.controllers.forms.ApproveLoanForm</type>
        </form>
        <form>
            <name>BookIdForm</name>
            <type>com.library.web.controllers.forms.BookIdForm</type>
        </form>
        <form>
            <name>LoanIdForm</name>
            <type>com.library.web.controllers.forms.LoanIdForm</type>
        </form>
        <form>
            <name>BookCreationForm</name>
            <type>com.library.web.controllers.forms.BookCreationForm</type>
        </form>
        <form>
            <name>BookManagementForm</name>
            <type>com.library.web.controllers.forms.BookManagementForm</type>
        </form>
        <form>
            <name>AddBookcaseForm</name>
            <type>com.library.web.controllers.forms.AddBookcaseForm</type>
        </form>
        <form>
            <name>UserProfileForm</name>
            <type>com.library.web.controllers.forms.UserProfileForm</type>
        </form>
    </forms>

    <!--
    Contains mappings to action depending on request path. Also may contains
     mapping to form and action's dependencies.
     <path> - URL path to action. Mandatory
     <type> - full qualified name of Action class. Mandatory
     <form-name> - mapped name of Form in group <forms>
     <dependency> - action's service dependency need to be injected. Optional
        <class> - full qualified name of Service class. Mandatory if dependency exists
        <name> - name of local Action's variable which need to be initialized by
        Service object value. Mandatory if dependency exists
     <validate> - true if Action needed html-form data. Optional
     <formName> - mapping to form. Optional
     <input> - URL path to html-form. Optional
     -->
    <action-mappings>
        <action>
            <path>/bookSearch</path>
            <type>com.library.web.controllers.actions.ShowBookSearchPageAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/bookSearch.do</path>
            <type>com.library.web.controllers.actions.BookSearchAction</type>
            <form-name>bookSearchForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/bookSearch.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/user/orderBook.do</path>
            <type>com.library.web.controllers.actions.OrderBookAction</type>
            <form-name>OrderBookForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/bookSearch.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/login.do</path>
            <type>com.library.web.controllers.actions.LoginAction</type>
            <form-name>userLoginForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/login.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.UserService</class>
                    <name>userService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/logout</path>
            <type>com.library.web.controllers.actions.LogoutAction</type>
        </action>
        <action>
            <path>/register.do</path>
            <type>com.library.web.controllers.actions.RegisterUserAction</type>
            <form-name>userRegistrationForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/registration.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.UserService</class>
                    <name>userService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/cabinet</path>
            <type>com.library.web.controllers.actions.ShowPersonalCabinetAction</type>
        </action>
        <action>
            <path>/admin/unapprovedLoans</path>
            <type>com.library.web.controllers.actions.ShowUnapprovedLoansAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/approve.do</path>
            <type>com.library.web.controllers.actions.ApproveLoanAction</type>
            <form-name>approveLoanForm</form-name>
            <validate>false</validate>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/activeBookLoans</path>
            <type>com.library.web.controllers.actions.ShowActiveBookLoansAction</type>
            <form-name>BookIdForm</form-name>
            <validate>false</validate>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/activeLoans</path>
            <type>com.library.web.controllers.actions.ShowActiveLoansAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/createBook</path>
            <type>com.library.web.controllers.actions.ShowBookCreationPageAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/createBook.do</path>
            <type>com.library.web.controllers.actions.CreateBookAction</type>
            <form-name>BookCreationForm</form-name>
            <validate>true</validate>
            <input>/admin/bookManagement/createBook</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/updateBook</path>
            <type>com.library.web.controllers.actions.ShowUpdateBookPage</type>
            <form-name>BookCreationForm</form-name>
            <validate>false</validate>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/updateBook.do</path>
            <type>com.library.web.controllers.actions.UpdateBookAction</type>
            <form-name>BookCreationForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/updateBook.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement</path>
            <type>com.library.web.controllers.actions.ShowBookManagementAction</type>
            <form-name>BookIdForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/bookManagement.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/addBooks.do</path>
            <type>com.library.web.controllers.actions.AddBooksAction</type>
            <form-name>BookManagementForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/addBooks.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LocationService</class>
                    <name>locationService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/removeBooks.do</path>
            <type>com.library.web.controllers.actions.RemoveBookAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LocationService</class>
                    <name>locationService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookManagement/deleteBooks.do</path>
            <type>com.library.web.controllers.actions.DeleteBookAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LocationService</class>
                    <name>locationService</name>
                </dependency>
                <dependency>
                    <class>com.library.services.BookService</class>
                    <name>bookService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/bookcaseManagement/add.do</path>
            <type>com.library.web.controllers.actions.AddBookcaseAction</type>
            <form-name>AddBookcaseForm</form-name>
            <validate>true</validate>
            <input>/WEB-INF/jsp/addBookcase.jsp</input>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LocationService</class>
                    <name>locationService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/admin/userProfile</path>
            <type>com.library.web.controllers.actions.ShowUserProfileAction</type>
            <form-name>UserProfileForm</form-name>
            <validate>false</validate>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.UserService</class>
                    <name>userService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/user/orderedBooks</path>
            <type>com.library.web.controllers.actions.ShowOrderedBooksAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/user/borrowedBooks</path>
            <type>com.library.web.controllers.actions.ShowBorrowedBooksAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/user/returnedBooks</path>
            <type>com.library.web.controllers.actions.ShowReturnedBooksAction</type>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/userCabinet/returnBook.do</path>
            <type>com.library.web.controllers.actions.ReturnBookAction</type>
            <form-name>LoanIdForm</form-name>
            <validate>false</validate>
            <service-dependencies>
                <dependency>
                    <class>com.library.services.LoanService</class>
                    <name>loanService</name>
                </dependency>
            </service-dependencies>
        </action>
        <action>
            <path>/changeLanguage</path>
            <type>com.library.web.controllers.actions.ChangeLanguageAction</type>
        </action>
    </action-mappings>

    <!--
    Mapping between web page files and its names.
    <entry> - one mapping
        <key> - web page's name
        <value> - web page's file
    -->
    <forwards>
        <entry>
            <key>/</key>
            <value>/WEB-INF/jsp/titlePage.jsp</value>
        </entry>
        <entry>
            <key>/title</key>
            <value>/WEB-INF/jsp/titlePage.jsp</value>
        </entry>
        <entry>
            <key>ShowTitlePage</key>
            <value>/WEB-INF/jsp/titlePage.jsp</value>
        </entry>
        <entry>
            <key>/login</key>
            <value>/WEB-INF/jsp/login.jsp</value>
        </entry>
        <entry>
            <key>ShowLoginPage</key>
            <value>/WEB-INF/jsp/login.jsp</value>
        </entry>
        <entry>
            <key>/registration</key>
            <value>/WEB-INF/jsp/registration.jsp</value>
        </entry>
        <entry>
            <key>ShowRegistrationPage</key>
            <value>/WEB-INF/jsp/registration.jsp</value>
        </entry>
        <entry>
            <key>ShowBookSearchPage</key>
            <value>/WEB-INF/jsp/bookSearch.jsp</value>
        </entry>
        <entry>
            <key>ShowUserCabinetPage</key>
            <value>/WEB-INF/jsp/userCabinet.jsp</value>
        </entry>
        <entry>
            <key>ShowAdminCabinetPage</key>
            <value>/WEB-INF/jsp/adminCabinet.jsp</value>
        </entry>
        <entry>
            <key>ShowPersonalCabinetAction</key>
            <value>/cabinet</value>
        </entry>
        <entry>
            <key>ShowBookUpdatingPage</key>
            <value>/WEB-INF/jsp/updateBook.jsp</value>
        </entry>
        <entry>
            <key>/admin/loansManagement</key>
            <value>/WEB-INF/jsp/loansManagement.jsp</value>
        </entry>
        <entry>
            <key>/admin/bookcaseManagement</key>
            <value>/WEB-INF/jsp/bookcaseManagement.jsp</value>
        </entry>
        <entry>
            <key>ShowBookcaseManagementPage</key>
            <value>/WEB-INF/jsp/bookcaseManagement.jsp</value>
        </entry>
        <entry>
            <key>showUnapprovedLoans</key>
            <value>/WEB-INF/jsp/unapprovedLoans.jsp</value>
        </entry>
        <entry>
            <key>ShowUnapprovedLoansAction</key>
            <value>/admin/unapprovedLoans</value>
        </entry>
        <entry>
            <key>showActiveBookLoansPage</key>
            <value>/WEB-INF/jsp/activeBookLoans.jsp</value>
        </entry>
        <entry>
            <key>showActiveLoansPage</key>
            <value>/WEB-INF/jsp/activeLoans.jsp</value>
        </entry>
        <entry>
            <key>showUserProfilePage</key>
            <value>/WEB-INF/jsp/userProfile.jsp</value>
        </entry>
        <entry>
            <key>showBookCreationPage</key>
            <value>/WEB-INF/jsp/bookCreation.jsp</value>
        </entry>
        <entry>
            <key>ShowBookManagementPage</key>
            <value>/WEB-INF/jsp/bookManagement.jsp</value>
        </entry>
        <entry>
            <key>BookManagementAction</key>
            <value>/admin/bookManagement</value>
        </entry>
        <entry>
            <key>ShowBookManagementPage</key>
            <value>/WEB-INF/jsp/bookManagement.jsp</value>
        </entry>
        <entry>
            <key>/admin/bookcaseManagement/add</key>
            <value>/WEB-INF/jsp/addBookcase.jsp</value>
        </entry>
        <entry>
            <key>ShowOrderedBooksPage</key>
            <value>/WEB-INF/jsp/userOrderedBooks.jsp</value>
        </entry>
        <entry>
            <key>ShowBorrowedBooksPage</key>
            <value>/WEB-INF/jsp/userBorrowedBooks.jsp</value>
        </entry>
        <entry>
            <key>ShowReturnedBooksPage</key>
            <value>/WEB-INF/jsp/userReturnedBooks.jsp</value>
        </entry>
        <entry>
            <key>ShowAccessDeniedPage</key>
            <value>/WEB-INF/jsp/accessDenied.jsp</value>
        </entry>
        <entry>
            <key>showErrorPage</key>
            <value>/WEB-INF/jsp/error.jsp</value>
        </entry>
        <entry>
            <key>successPage</key>
            <value>/WEB-INF/jsp/successfulRedirect.jsp</value>
        </entry>
    </forwards>

    <!--
    Contains mapping between constrained resources URL and
    authorized for them roles.
    <resource> - constrained resource
        <url-pattern> - URL pattern to constrained resource
        <role> - role which authorized for visiting
        constrained resource
    -->
    <security-constraint>
        <resource>
            <url-pattern>/user</url-pattern>
            <allowed-roles>
                <role>USER</role>
            </allowed-roles>
        </resource>
        <resource>
            <url-pattern>/admin</url-pattern>
            <allowed-roles>
                <role>ADMINISTRATOR</role>
            </allowed-roles>
        </resource>
        <resource>
            <url-pattern>/cabinet</url-pattern>
            <allowed-roles>
                <role>ADMINISTRATOR</role>
                <role>USER</role>
            </allowed-roles>
        </resource>
    </security-constraint>

</servlet-config>
